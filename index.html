<h1>Event stream</h1>
<p id="desc"></p>
<ul id="list"></ul>

<script>
    const url = new URL(location.href);
    const orderId = url.searchParams.get('orderId');
    if (orderId) {
        const evtSource = new EventSource("/events?orderId=" + orderId);
        evtSource.onmessage = (event) => {
            const newElement = document.createElement("li");
            const eventList = document.getElementById("list");

            console.log(event);
            newElement.textContent = `${event.data}`;
            eventList.appendChild(newElement);
        };

        evtSource.onerror = (err) => {
            console.error('event source error', err);
        }

        document.getElementById('desc').innerText = 'Listening on updates to order ' + orderId;
    }
    else 
        document.getElementById('desc').innerText = 'orderId query param missing';
</script>